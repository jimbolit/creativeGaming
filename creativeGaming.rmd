---
title: "ASSIGNMENT NAME"      # Replace with name of assignment
author: 
   - name: Section 81         # Replace with your section number
   - name: James Little
   - name: Mario Estrada
   - name: Greg Schiffenhaus       # add/delete rows for more/fewer names as needed. 
output:
  html_notebook: default
---

# Preliminaries

### Determine notebook defaults:
```{r, include=FALSE}
knitr::opts_chunk$set(echo=TRUE,      # Print all the code in all the chunks
                      warning=FALSE,  # Don't print warning statements
                      message=FALSE,  # Don't print other R output messages
                      comment=NA)     # Helps produce prettier output
```

### Load packages:
```{r, echo=FALSE, message = FALSE, warning = FALSE}
library(gmodels)
library(modelr)
library(janitor)
library(haven)
library(readxl)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(sjPlot)
library(mktg482) 
library(openxlsx)
library(scales)
library(dplyr)
library(skimr)
```

### Read in the data:
```{r}
load("creative_gaming.Rdata") 
```

# Assignment answers

### Part I

### Question 1

What is the organic probability of converting to Zalon?

```{r}
organicConvertVar <- (cg_organic %>% summarise(organicConvert = mean(converted)))$organicConvert
cat("Organic probability of converting to Zalon: ", percent(organicConvertVar, .01))
```

### Question 2

For each feature, show basic summary statistics.

```{r}
skim_without_charts(cg_organic)
```

## Part II

## Question 1

Create a training and test sample based on the “cg_organic” dataframe. What is the training/test split?

```{r}
cg_organic_train <- cg_organic[sample_train_org,] 
cg_organic_test <- cg_organic[-sample_train_org,]

nrow(cg_organic_train)
nrow(cg_organic_train)/nrow(cg_organic)
nrow(cg_organic_test)
nrow(cg_organic_test)/nrow(cg_organic)

```

## Question 2

Train a logistic regression model using all features

```{r}
 lr <- glm(converted ~ GameLevel + NumGameDays + NumGameDays4Plus + NumInGameMessagesSent + NumFriends + NumFriendRequestIgnored + NumSpaceHeroBadges + AcquiredSpaceship + AcquiredIonWeapon + TimesLostSpaceship + TimesKilled + TimesCaptain + TimesNavigator + PurchasedCoinPackSmall + PurchasedCoinPackLarge + NumAdsClicked + DaysUser + UserNoConsole + UserHasOldOS , data = cg_organic_train)
summary(lr)

```
```{r}
plot_model(lr, show.values = TRUE, transform = NULL)
```


```{r fig2, fig.height = 3, fig.width = 3, fig.align = "center"}
plot_model(lr, type= "eff")
```

```{r}
varimp.logistic(lr) %>% plotimp.logistic()
```

The 5 most important features are
- Number of space hero badges
- Number of friend requests ignored
- Times lost spaceship
- Acquired ion weapon
- Acquired spaceship

